# TÃªn tá»‡p: .github/workflows/backend.yml
name: Triá»ƒn khai Backend (BE)

# KÃ­ch hoáº¡t khi cÃ³ sá»± kiá»‡n push lÃªn nhÃ¡nh main
on:
  push:
    branches:
      - main
    paths:
      - 'backend/**' # CHá»ˆ cháº¡y khi cÃ³ thay Ä‘á»•i trong thÆ° má»¥c 'backend'

jobs:
  deploy_backend:
    name: Triá»ƒn khai BE qua FTP
    runs-on: ubuntu-latest

    steps:
      - name: â¬‡ï¸ Checkout code
        uses: actions/checkout@v4

      # â¬†ï¸ BÆ¯á»šC TRIá»‚N KHAI QUA FTP
      - name: Triá»ƒn khai BE lÃªn Host
        uses: SamKirkland/FTP-Deploy-Action@v4.3.0
        with:
          server: ${{ secrets.FTP_HOST_BE }}
          username: ${{ secrets.FTP_USERNAME_BE }}
          password: ${{ secrets.FTP_PASSWORD_BE }}
          port: 21
          local-dir: ./backend/ # ThÆ° má»¥c local chá»©a code BE
          server-dir: /api/ # ThÆ° má»¥c Ä‘Ã­ch trÃªn host (vÃ­ dá»¥: má»™t thÆ° má»¥c tÃªn lÃ  'api')
          # delete-removed-files: true
          
      # ğŸš€ BÆ¯á»šC KHá»I Äá»˜NG Láº I Dá»ŠCH Vá»¤ (Chá»‰ cáº§n náº¿u lÃ  NodeJS/Java/Python)
      # Náº¿u lÃ  PHP (vÃ­ dá»¥: Laravel), báº¡n cÃ³ thá»ƒ bá» qua bÆ°á»›c nÃ y.
      # Äá»ƒ cháº¡y lá»‡nh qua SSH, báº¡n cáº§n thÃªm SSH key vÃ o Secrets vÃ  dÃ¹ng action SSH
      # - name: Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥ Backend (VÃ­ dá»¥: NodeJS)
      #   if: ${{ false }} # Äáº·t lÃ  'true' náº¿u báº¡n cáº§n khá»Ÿi Ä‘á»™ng láº¡i
      #   uses: appleboy/ssh-action@v1.0.3
      #   with:
      #     host: ${{ secrets.SSH_HOST }}
      #     username: ${{ secrets.SSH_USERNAME }}
      #     key: ${{ secrets.SSH_PRIVATE_KEY }}
      #     script: |
      #       cd /path/to/backend/
      #       pm2 restart my-node-app